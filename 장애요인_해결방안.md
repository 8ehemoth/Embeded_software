
# 예상되는 장애 요인
**운전자가 실제 졸음 상태임에도 시스템이 이를 감지하지 못해 False Negative가 발생할 수 있습니다.**
- 졸음 데이터(눈 감김, 하품, 머리 떨림 등)가 다양하게 반영되지 않아 학습 부족

# 해결 방안
1. **Positive 샘플 확대**: 다양한 조명·카메라 각도·운전 조건에서 졸음 데이터 수집 및 증강  
2. **임계치 및 가중치 조정**: threshold를 낮춰 Recall 증가, 손실 함수에 positive 클래스 가중치 조정/SMOTE 적용  
3. **멀티모달 융합**: 눈 감김 외에 하품, 심박수, 피부전도(GSR), 머리 기울임(IMU) 등 보조 신호 통합  
4. **시간적 패턴 모델링**: HMM/LSTM 시퀀스 분석으로 일관된 졸음 패턴 검출  
5. **온라인 학습 및 피드백 루프**: 운행 중 수집된 신규 데이터로 주기적 모델 업데이트  

# 임계치 낮춤에 따른 오경보 문제
**Threshold를 낮추면 민감도(Recall)는 올라가지만 False Positive(오경보)가 증가하여 운전자 경고 피로 발생 가능**


# 오경보 해결 방안
1. **ROC/PR 분석**  
   - 검증 데이터에 대해 confidence(threshold)를 0.1에서 0.9까지 변화시키며 각 지점의 Precision, Recall, FPR, TPR을 계산합니다.  
   - `sklearn.metrics.roc_curve`와 `precision_recall_curve` 함수를 사용해 ROC/PR 곡선을 그린 뒤, F1 스코어가 최대이거나 허용 가능한 FPR 대비 TPR이 가장 높은 임계치를 선택합니다.

2. **Adaptive Thresholding**  
   - 주행 속도, 주변 조도, 운전자의 평균 깜빡임 속도 같은 컨텍스트 변수를 실시간으로 측정합니다.  
   - 기본 임계치(base_th)를 수정하는 함수(`adaptive_th`)를 구현하여, 속도가 빠를 때 임계치를 낮추고 깜빡임이 잦을 때는 임계치를 올리는 방식으로 동적으로 조정합니다.

3. **멀티모달 교차검증**  
   - 영상 기반 판단 전에 심박수, 피부전도(GSR), IMU(머리 기울임) 신호를 함께 확인합니다.  
   - 영상에서만 졸음 징후가 감지될 경우, 보조 센서가 일정 기준 이상 감지될 때까지 경고를 지연시켜 오탐을 줄입니다.
