# 🛠️ 임베디드SW 경진대회 프로젝트 지침서

## 📌 프로젝트명: WakeMate
## 💡 주제: 졸음운전 감지 기반 대화형 운전자 케어 시스템

---

## 1. 🎯 프로젝트 개요 및 목적

운전 중 졸음은 매우 위험한 사고 원인 중 하나로, 운전자의 생명뿐 아니라 타인의 안전까지 위협합니다.  
본 프로젝트는 졸음운전을 실시간으로 감지하고, 운전자에게 대화형 음성 인터페이스를 제공하여 각성 및 안전 확보를 목표로 합니다.

졸음 감지 이후, 운전자의 음성을 인식하고, 이를 OpenAI(ChatGPT) API로 전달한 후, 응답을 자연어로 음성 출력하는 시스템을 구축함으로써 운전자의 피로 회복을 유도하고 능동적인 운전 보조 시스템을 구현합니다.

또한, 졸음운전이 감지되지 않은 정상 상태에서는 운전자의 음성 명령을 인식해 차량 내 액추에이터를 제어하는 기능을 제공하며, 이를 CAN 통신 기반으로 구성하여 실제 차량 구조와 유사한 시스템을 구현합니다.

---

## 2. 🔍 핵심 기능 요약

| 구분 | 내용 |
|------|------|
| 졸음 감지 | 카메라 기반 눈 깜빡임/감김 감지 또는 차량 센서 기반 |
| 음성 인식 (STT) | 운전자의 질문을 실시간 텍스트로 변환 (Google/Naver API 등) |
| AI 대화 (ChatGPT API) | 인식된 문장을 ChatGPT에 전달, 응답 텍스트 수신 |
| 음성 출력 (TTS) | 텍스트 응답을 음성으로 변환 후 차량 내 스피커 출력 |
| 로컬 제어 기능 | 졸음 미감지 시, 음성으로 창문, 에어컨, 조명 등 제어 (CAN 기반) |

---

## 3. ⚙️ 시스템 구성도

```
[졸음 감지 모듈] → [음성 인식] → [ChatGPT API 통신] → [TTS 출력] → [운전자 피드백]
        ↑                                                        ↓
   [카메라 / 센서]                               [스피커, 부저, LED 등]

             ↳ (정상 운전 상태)
               [음성 명령] → [CAN 메시지 생성] → [MCP2515 송신]
                                              ↓
                                 [MCP2515 수신 → GPIO 제어 → 액추에이터 작동]
```

---

## 4. 🧩 사용 기술 및 플랫폼

| 항목 | 내용 |
|------|------|
| MCU/보드 | Raspberry Pi 5 (필수) + Camera Module 3 |
| 센서 | USB/CSI 카메라 또는 IR센서, MPU6050 (선택) |
| STT | Google Speech-to-Text API or Naver Clova |
| Chat API | OpenAI ChatGPT API (gpt-4 or gpt-3.5-turbo) |
| TTS | gTTS, Naver Clova Dubbing, pyttsx3 |
| 음성 출력 | 3.5mm 오디오잭, USB 스피커, 블루투스 모듈 |
| 액추에이터 제어 | MCP2515 + CAN 통신 + GPIO (수신 측) |
| 개발 언어 | Python 중심, 필요시 Bash/Node.js 병행 |
| OS | Raspberry Pi OS (64bit Lite/Full) |

---

## 5. 👥 역할 분담 예시

| 역할 | 담당 업무 |
|------|------------|
| 팀장 | 전체 일정 관리, API 연동 및 통합 구현 |
| 하드웨어 담당 | 졸음 감지 센서 연결 및 신호처리, MCP2515 CAN 구성 |
| 소프트웨어 담당 | STT/TTS 및 ChatGPT API 파이프라인 구축, CAN 메시지 처리 |
| UI/UX 담당 | 대시보드/상태 화면 구성, 태블릿 연동 (선택) |
| 발표 자료 담당 | 보고서 및 시연 영상 준비, 전시부스 설계 등 |

---

## 6. 📝 예상 시나리오 흐름

1. 졸음 감지 알고리즘이 일정 기준 이상 감지 → 부저/LED로 경고
2. 시스템이 음성으로 유도:
   > “졸음이 감지되었습니다. 대화를 시작하시겠습니까?”
3. 운전자가 말함:
   > “오늘 날씨는 어때?”
4. STT로 텍스트 변환 → ChatGPT 요청
5. 응답:
   > “현재 위치 기준 흐림, 기온은 22도입니다. 창문을 닫는 걸 추천드려요.”
6. TTS를 통해 음성 출력

✅ **(정상 상태)** 졸음이 감지되지 않을 경우:
- 운전자가 “에어컨 켜줘”라고 말함
- STT로 명령 인식 → `CAN ID=0x200, data=0x01` 생성
- MCP2515를 통해 송신 → 수신 측 Pi가 메시지를 해석
- GPIO 제어를 통해 릴레이/모터 등 액추에이터 동작

---

## 7. 📦 확장 아이디어 (선택 구현)

- 졸음 감지 외에도 스마트폰 조작, 산만 운전 감지 확장
- Wake word 기반 호출 기능: “하이 웨이크메이트”
- 차량 내 IoT 제어: 창문, 공조, 조명 등 음성 기반 제어
- 운전자 상태 분석 데이터 저장 및 클라우드 연동


---

## 🧠 프로젝트 개요

**HyBud**는 "Hyundai"와 "Buddy"의 합성어로, 졸음운전 중인 운전자에게 친구처럼 말을 걸어 깨워주는 **인터랙티브 AI 운전 보조 시스템**입니다.

- 운전자의 졸음 상태를 **온디바이스 AI와 센서 데이터**를 기반으로 실시간 감지  
- **ChatGPT API**를 통해 자연스러운 대화를 유도하여 주의력 회복  
- **웨어러블 기기** 및 차량 내외부 환경 정보(CO₂, 온습도, 카메라 등)를 통합하여 **맞춤형 운전 경험 제공**

---

## 🎯 개발 목표

- 졸음운전을 실시간으로 감지하고, **음성 기반 대화 시스템**을 통해 운전자의 집중력 회복 유도
- **STT → GPT 응답 → TTS**의 음성 파이프라인 구축
- 사고 예방 및 운전자 안전 확보를 위한 **능동적 운전 보조 시스템 구현**

---

## 🔎 개발 배경

- 졸음운전 사고는 **음주운전보다 높은 치사율**을 보임  
- 경찰청 통계(2019~2023): 졸음운전 사고 10,790건, 하루 평균 5.9건, 사망자 317명  
- 졸음운전의 위험성과 심각성에 따라 **실시간 감지와 대응 시스템**의 필요성이 높아짐  
- ChatGPT API와 음성 인터페이스를 활용한 **맞춤형 대응 시스템 구현**

---

## ⚙️ 시스템 구성

```
[웨어러블 디바이스 / 카메라] 
       ↓
[라즈베리파이 판단 모듈] 
       ↓
[ChatGPT API ↔ 음성 입출력]
       ↓
[스피커 및 사용자 피드백]
```

- **WD (Wearable Device)**: 수면 시간, 심박수 등 데이터 제공  
- **Built-in Camera**: 얼굴 인식 기반 졸음 여부 판단 (EAR 알고리즘, dlib, opencv or AI 모델 + Hailo 가속기 사용)  
- **라즈베리파이**: 센서 데이터 통합 → 졸음 판단 → ChatGPT API 호출 → TTS 변환 후 출력  
- **STT**: Google STT API 또는 Whisper 로컬 모델 사용

---

## 🛠️ 사용 기술 및 장비

### ▪ 소프트웨어 (SW)

- 음성 인식 모델: Google STT API, Whisper (Transformer 기반)  
- 자연어 처리: OpenAI ChatGPT API  
- 음성 합성: gTTS or pyttsx3  
- Python 라이브러리: SpeechRecognition, dlib, opencv 등  
- TTS/STT 최적화: 캐시 활용, 텍스트 임베딩 적용 예정

### ▪ 하드웨어 (HW)

- 라즈베리파이 5 + 카메라 모듈 3  
- CO₂ 센서, 온습도 센서, 마이크, 스피커  
- Coral EdgeTPU (선택사항, TFLite 모델 최적화 시)  
- Hailo-8 (선택사항, 실시간 추론 가속)

---

## 🚧 개발 전략 및 해결 방안

- **1차 STT**는 Google API로 구현하고, 정확도/속도 문제 발생 시 **로컬 모델(Whisper)**로 전환  
- ChatGPT API의 **응답 지연/비용** 문제는 캐싱과 임베딩 검색으로 최적화  
- Hailo/Coral EdgeTPU와 같은 하드웨어 가속기로 모델 추론 속도 개선

